é€šè¿‡å¤§å°ç»é”€å•†ã€é›¶å”®å•†ï¼Œ æˆ‘ä»¬é‡è¦å°†é›ªç³•é¡ºåˆ©çš„æ¬è¿åˆ°å®¢æˆ·æ‰‹ä¸­ï¼›ä½†çŽ°åœ¨åˆå‡ºçŠ¶å†µäº†ï¼Œå®¢æˆ·å°æ˜Žå¹¶ä¸å¼€å¿ƒï¼Œå› ä¸ºä»–æœ‰å†¤æ— å¤„è¯´ï¼Œä¸çŸ¥é“å’Œè°è¯´ã€‚

äº‹æƒ…æ˜¯è¿™æ ·çš„ï¼Œå°æ˜Žä¸‹ç­åŽ»ä¹°ä»–æœ€å–œæ¬¢è‰èŽ“é›ªç³•ï¼Œå‘çŽ°åªæœ‰æœ€åŽä¸€æ ¹äº†ï¼›ä½†æ‹¿åˆ°æ‰‹å‘çŽ°ï¼Œé›ªç³•æœ‰ç‚¹åŒ–äº†ï¼›å¥½äººå°æ˜Žå¿ƒæƒ³æœ€åŽä¸€æ ¹äº†å°±å°†å°±ä¸€ä¸‹ã€‚

ç»“æžœç­‰æ‰“å¼€å‘çŽ°ï¼Œè‰èŽ“é›ªç³•åŒ…è£…é‡Œé¢ï¼Œå±…ç„¶æ˜¯è®©ä»–è¿‡æ•çš„é¦™è‰é›ªç³• ðŸ˜©

è¿™è®©å°æ˜Žå¾ˆæ²®ä¸§ï¼Œå°æ˜Žæƒ³è¦åé¦ˆæƒ…å†µï¼Œå½“ä¸çŸ¥é“æ‰¾è°åˆé€‚ã€‚



## åœºæ™¯åˆ†æž

è¿™é‡Œåˆ†æžä¸€ä¸‹å°æ˜Žé‡åˆ°äº†çš„é—®é¢˜ã€é—®é¢˜çš„è§£å†³æ–¹ã€é—®é¢˜çš„è§£å†³åŠžæ³•ï¼š

|          é—®é¢˜          |         è§£å†³æ–¹         |   è§£å†³åŠžæ³•   |
| :--------------------: | :--------------------: | :----------: |
|   è‰èŽ“é›ªç³•åªæœ‰ä¸€æ ¹äº†   |         é›¶å”®å•†         | åŠæ—¶è¡¥å……é›ªç³• |
|      é›ªç³•æœ‰ç‚¹åŒ–äº†      | æ•´ä¸ªè¿è¾“çº¿ï¼ŒåŒ…æ‹¬é›¶å”®å•† | æé«˜å†·é“¾èƒ½åŠ› |
| è‰èŽ“é›ªç³•é‡Œè£…äº†é¦™è‰é›ªç³• |          åŽ‚å®¶          | æä¾›ç›‘ç®¡èƒ½åŠ› |

è¿™é‡Œå¦‚æžœå°æ˜Žå¸Œæœ›èƒ½å®Œæ•´çš„åé¦ˆæ•´ä¸ªé—®é¢˜ï¼Œéœ€è¦çŸ¥é“æ‰€æœ‰çš„è´Ÿè´£äººçš„è”ç³»æ–¹å¼ï¼Œå¹¶é€ä¸€å°†å¯¹åº”çš„é—®é¢˜åé¦ˆã€‚

è¿™å¯¹å°æ˜Žè€Œå·²æ˜¯å›°éš¾çš„ï¼Œç”šè‡³ä¸å¯å®žçŽ°çš„ï¼›æ¯”å¦‚ï¼Œä¸­é—´çš„æŸä¸ªç»é”€å•†å°±æ˜¯å°æ˜Žæ— æ³•è”ç³»ä¸Šçš„ã€‚

è¿™é‡Œå¦‚æžœåŽ‚å®¶å¦‚æžœå¯ä»¥å»ºç«‹å®Œæ•´çš„åé¦ˆé“¾æ¡ï¼Œå°æ˜Žå°±å¯ä»¥ç›´æŽ¥å°†è‡ªå·±æ‰€æœ‰çš„åé¦ˆäº¤ç»™é›¶å”®å•†ï¼›ä»Žè€Œè®©æ•´ä¸ªé›ªç³•ä¾›ç»™ç³»ç»Ÿæ´»åŠ¨åé¦ˆã€‚



## å®žçŽ°æ€è·¯

![èŒè´£é“¾æ¨¡å¼](18èŒè´£é“¾æ¨¡å¼.assets/èŒè´£é“¾æ¨¡å¼.drawio.svg)

### æŽ¥å£Handler

å®šä¹‰äº†å¤„ç†çš„æŽ¥å£æ¨¡å¼

```cpp
class Handler
{
public:
	Handler* getNext() { return next; }
	void setNext(Handler* handler) { next = handler; }

	void handleRequest(Request* request)
	{
		bool handled = false;
		this->handle(request, handled);
		if (!handled)
		{
			getNext()->handleRequest(request);
		}
	}

	virtual void handle(Request* request, bool& handled) = 0;
private:
	Handler* next;
};
```



### æŽ¥å£Request

```cpp
class Request
{
public:
	Request(RequestType type, string message)
		: m_Type(type)
		, m_sMessage(message)
	{

	}

	RequestType getType()
	{
		return m_Type;
	}

	string getMessage()
	{
		return m_sMessage;
	}

private:
	RequestType m_Type;
	string m_sMessage;
};
```



### å…·ä½“å¤„ç†ç±»

```cpp
// é›¶å”®å•†
class RetailerHandler : public Handler
{
public:
	virtual void handle(Request* request, bool& handled)
	{
		if (request->getType() == RequestType::retaile)
		{
			cout << "é›¶å”®å•†å¤„ç†é—®é¢˜ï¼š" << request->getMessage() << endl;
			handled = true;
		}
	}
};

// ç»é”€å•†
class DealerHandler : public Handler
{
public:
	virtual void handle(Request* request, bool& handled)
	{
		if (request->getType() == RequestType::dealer)
		{
			cout << "ç»é”€å•†å¤„ç†é—®é¢˜ï¼š" << request->getMessage() << endl;
			handled = true;
		}
	}
};

// åŽ‚å®¶
class FactoryHandler : public Handler
{
public:
	virtual void handle(Request* request, bool& handled)
	{
		if (request->getType() == RequestType::factory)
		{
			cout << "åŽ‚å®¶å¤„ç†é—®é¢˜ï¼š" << request->getMessage() << endl;
			handled = true;
		}
	}
};
```



### mainå‡½æ•°

è¿™é‡Œçš„main

```cpp
int main(int argc, char* argv[])
{
	RetailerHandler oHandler1;
	DealerHandler oHandler2;
	FactoryHandler oHandler3;

	oHandler1.setNext(&oHandler2);
	oHandler2.setNext(&oHandler3);

	Request oRequest1(RequestType::retaile, "é›ªç³•åªæœ‰ä¸€ä¸ªäº†");
	oHandler1.handleRequest(&oRequest1);

	Request oRequest2(RequestType::factory, "è‰èŽ“é›ªç³•è¢‹è£…äº†é¦™è‰é›ªç³•");
	oHandler1.handleRequest(&oRequest2);

	return 0;
};
```



è¿è¡Œç»“æžœï¼š ![è¿è¡Œç»“æžœ](18èŒè´£é“¾æ¨¡å¼.assets/202208032001439.png)

## æ„Ÿæ‚Ÿ

### å¯æ”¹è¿›é¡¹

è¿™é‡Œçš„Requestå®šä¹‰ä¸æ˜¯åº”è¯¥ç‰¹åˆ«è‰¯å¥½çš„æ–¹å¼ã€‚ RequestType çš„å­˜åœ¨è™½ç„¶å¯ä»¥æ˜Žç¡®å®šä¹‰Requestçš„ç±»åž‹ï¼Œä½†ä¹Ÿå¯¼è‡´äº†**å‘é€æ–¹**ï¼Œéœ€è¦çŸ¥é“æ›´å¤šæƒ³ä¿¡æ¯ã€‚å¯¼è‡´è€¦åˆçš„åŠ æ·±ï¼Œè¿™å¹¶ä¸ç¬¦åˆèŒè´£é“¾åŽ»åˆ†ç¦» **å‘é€æ–¹** å’Œ **æŽ¥æ”¶æ–¹**çš„åˆè¡·ã€‚

å¦‚æžœåœ¨å®žé™…ä½¿ç”¨ä¸­å¸Œæœ›é€šè¿‡ RequestType åšæ˜Žç¡®çš„åˆ’åˆ†ï¼Œå¯ä»¥è€ƒè™‘å†åšä¸€å±‚å°è£…ï¼ŒåšRequestçš„æ ‡å‡†ç”Ÿäº§å‡½æ•°ã€‚

### ç”¨æ³•

å½“å‰çš„èŒè´£é“¾ä½¿ç”¨äº†ï¼š

**çº¯çš„èŒè´£é“¾æ¨¡å¼**ï¼šä¸€ä¸ªè¯·æ±‚å¿…é¡»è¢«æŸä¸€ä¸ªå¤„ç†è€…å¯¹è±¡æ‰€æŽ¥æ”¶ï¼Œä¸”ä¸€ä¸ªå…·ä½“å¤„ç†è€…å¯¹æŸä¸ªè¯·æ±‚çš„å¤„ç†åªèƒ½é‡‡ç”¨ä»¥ä¸‹ä¸¤ç§è¡Œä¸ºä¹‹ä¸€ï¼šè‡ªå·±å¤„ç†ï¼ˆæ‰¿æ‹…è´£ä»»ï¼‰ï¼›æŠŠè´£ä»»æŽ¨ç»™ä¸‹å®¶å¤„ç†ã€‚

ä½†æ˜¯å°æ˜Žçš„é—®é¢˜é‡Œè¿˜æœ‰ä¸€ä¸ªæ˜¯: é›ªç³•æœ‰ç‚¹åŒ–äº†,è¿™é‡Œç”¨**çº¯çš„èŒè´£é“¾æ¨¡å¼**å°±ä¸èƒ½èƒœä»»ã€‚åŠéœ€è¦ï¼š

**ä¸çº¯çš„èŒè´£é“¾æ¨¡å¼**ï¼šå…è®¸å‡ºçŽ°æŸä¸€ä¸ªå…·ä½“å¤„ç†è€…å¯¹è±¡åœ¨æ‰¿æ‹…äº†è¯·æ±‚çš„ä¸€éƒ¨åˆ†è´£ä»»åŽåˆå°†å‰©ä½™çš„è´£ä»»ä¼ ç»™ä¸‹å®¶çš„æƒ…å†µï¼Œä¸”ä¸€ä¸ªè¯·æ±‚å¯ä»¥æœ€ç»ˆä¸è¢«ä»»ä½•æŽ¥æ”¶ç«¯å¯¹è±¡æ‰€æŽ¥æ”¶ã€‚

æ€»çš„æ¥è¯´ï¼šèŒè´£é“¾æ¨¡å¼ æ˜¯ä¸ºäº† åˆ†ç¦» **å‘é€æ–¹** å’Œ **æŽ¥æ”¶æ–¹**ï¼› æ‰€ä»¥éœ€è¦åœ¨è®¾è®¡æ—¶ï¼Œä¹Ÿå°½å¯èƒ½å‡å°‘è€¦åˆã€‚



## ä»£ç ä½ç½®

https://github.com/su-dd/learning/tree/main/src/design_pattern/ChainOfResponsibility